---
layout: post
title: çº¿æ€§å›å½’(ä¸Š) -- å¼•å­
date: 2017-04-01 19:12:35 +0800
categories: Essays
tag: Machine Learnging
---
{:.af-textAlignCenter}
![png](/assets/imgs/2017-04-01-poster.png)


{:.af-sectionDivider}
çº¿æ€§å›å½’å¾ˆç®€å•å‘€ï¼ä»è¿™ä¸ªè¯ä¸­å¯ä»¥çœ‹åˆ°ä¸¤ç‚¹ï¼Œçº¿æ€§ä¸å›å½’ã€‚

æˆ‘ä»¬å…ˆä»æœ€ç®€å•çš„çº¿æ€§è¯´èµ·ã€‚è¯´èµ·çº¿ï¼Œæœ€ç®€å•çš„å½“ç„¶è¿˜æ˜¯ç›´çº¿äº†ã€‚ç»™å‡ºä»»æ„ä¸¤ç‚¹å¯ä»¥ç”»å‡ºä¸€æ¡ç›´çº¿ï¼ˆå½“ç„¶æˆ‘è¯´çš„æ˜¯[æ¬§æ°å‡ ä½•](https://en.wikipedia.org/wiki/Euclidean_geometry)ï¼‰ã€‚

{:.af-textAlignCenter}
![png](/assets/imgs/2017-04-01-straight-line.png)


é‚£é—®ä¸€ä¸ªç®€å•çš„é—®é¢˜ï¼Œç»™ä½ ä¸‰ä¸ªç‚¹ä¸å…±çº¿ï¼Œä½ è¿˜èƒ½ç”»å‡ºä¸€æ¡è¿‡è¿™ä¸‰ä¸ªç‚¹çš„ç›´çº¿å—ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ï¼Œå› ä¸ºå·²ç»è¯´äº†æ˜¯ä¸å…±çº¿çš„ä¸‰ç‚¹ï¼Ÿä½†æ˜¯å¦‚æœéè¦ç”»ä¸€æ¡ç›´çº¿æ€ä¹ˆåŠï¼Ÿç»™å‡ºä¸€ä¸ª[æ‰˜é©¬æ–¯](https://baike.baidu.com/item/%E6%89%98%E9%A9%AC%E6%96%AF%E5%92%8C%E4%BB%96%E7%9A%84%E6%9C%8B%E5%8F%8B%E4%BB%AC/752251?fr=aladdin)çš„é—®é¢˜ï¼Œå‡è®¾è¦åœ¨ç¾ä¸½çš„[å¤šå¤šå²›](https://baike.baidu.com/item/%E5%A4%9A%E5%A4%9A%E5%B2%9B/22098341)ä¸Šçš„ä¸‰ä¸ªåŸå¸‚ä¿®æ¡é“è·¯ï¼Œè¿™ä¸‰ä¸ªç«™ä¸å…±çº¿ï¼Œä½†æ˜¯å°ç«è½¦åˆåªèƒ½å¼€ç›´çº¿ï¼Œé‚£ä¹ˆè¿™æ¡ç¬”ç›´çš„é“è·¯è¦æ€ä¹ˆä¿®é‚£ï¼Ÿ

{:.af-textAlignCenter}
![png](/assets/imgs/2017-04-01-tri-points.png)

æœ€ä¼˜çš„æ–¹æ¡ˆæ˜¯ä¿®ä¸€æ¡é“è·¯ç¦»ä¸‰ä¸ªç«™ç‚¹çš„æ€»è·ç¦»æ˜¯æœ€å°çš„ã€‚æˆ‘ä»¬æ€ä¹ˆæ‰¾åˆ°å‡ºæ¡ç›´çº¿é‚£ï¼Ÿä¸‹é¢æˆ‘ä»¬å°è¯•ç”¨çº¿æ€§ä»£æ•°ä¸­çš„æŠ•å½±çŸ©é˜µçŸ¥è¯†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚


{:.af-sectionDivider}
### æŠ•å½±é—®é¢˜

æ€ä¹ˆç”¨è¿™ä¸‰ä¸ªç‚¹å½¢æˆçš„å‘é‡è¡¨ç¤ºä¸€æ¡ç›´çº¿ï¼Œä½¿å¾—è¿™æ¡ç›´çº¿ç¦»è¿™ä¸‰ä¸ªç‚¹çš„æ€»è·ç¦»æœ€è¿‘ã€‚ä¸‹é¢å¼•ç”¨çº¿æ€§ä»£æ•°çš„æŠ•å½±é—®é¢˜ã€‚

{:.af-textAlignCenter}
![jpg](/assets/imgs/2017-10-01-vector-projection.jpg)

äºŒç»´å‘é‡ç©ºé—´ä¸­ï¼Œ$$\vec{a}, \vec{b}$$ æ˜¯çº¿æ€§ä¸ç›¸å…³çš„ï¼Œå¾ˆæ˜¾ç„¶ä¸¤ä¸ªå‘é‡ä¹‹é—´æ˜¯æ— æ³•ç›¸äº’è¡¨ç¤ºçš„ã€‚å¦‚æœéè¦ç”¨ $$\vec{a}$$ æ¥è¡¨ç¤º $$\vec{b}$$ ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆè¡¨ç¤ºé‚£ï¼Ÿå‡è®¾æˆ‘ä»¬æ‰¾å‡ºå‘é‡ $$\vec{p}$$ è¡¨ç¤º $$\vec{b}$$ï¼Œè¿™ç§è¡¨ç¤ºè‚¯å®šæ˜¯æœ‰è¯¯å·®çš„ã€‚è¿™ä¸ªè¯¯å·®æ€ä¹ˆè®¡ç®—ï¼Œå¯ä»¥ç®—ä¸¤ä¸ªå‘é‡çš„ [cosine å€¼](https://en.wikipedia.org/wiki/Cosine_similarity)è¡¨ç¤ºä¸¤ä¸ªå‘é‡çš„å·®å¼‚ã€‚å‡è®¾è¯¯å·®å‘é‡ä¸º $$\vec{e}$$ï¼Œé‚£ä¹ˆå½“ $$\vec{b}$$ ä¸ $$\vec{b}$$å‚ç›´æ­£äº¤æ—¶çš„è¯¯å·®ï¼ˆè·ç¦»ï¼‰æœ€å°å–½ã€‚æ‰€ä»¥çœ‹å‡ºæŠ•å½±é—®é¢˜ä¹Ÿæ˜¯è§£å†³æ€ä¹ˆæ‰¾åˆ°æœ€å°è·ç¦»çš„é—®é¢˜ã€‚

ä¸‹é¢å°±æŠ•å½±é—®é¢˜ä¾‹ä¸‹å…¬å¼ï¼Œ æŠ•å½± $$\vec{p} = \hat{x}\vec{a}$$ï¼Œ è¯¯å·® $$\vec{e} = \vec{b} - \vec{p} = \vec{b} - \hat{x}\vec{a}$$ã€‚$$\vec{e}$$ ä¸ $$\vec{a}$$ æ­£äº¤ï¼Œæ‰€ä»¥æœ‰ $$\vec{a}^T \cdot \vec{e} = 0$$ï¼š

$$
\begin{aligned}
        \vec{a} ^ T \cdot \vec{e} &= 0 \\
        \vec{a} ^ T \cdot (\vec{b} - \hat{x}\vec{a}) &= 0 \\
        \vec{a} ^ T \vec{b} &= \hat{x} \vec{a} ^ T \vec{a} \\
        \hat{x} &= \frac{\vec{a} ^ T \vec{b}} {\vec{a} ^ T \vec{a}}
\end{aligned}
$$

æ‰€ä»¥ï¼Œ

$$
\begin{aligned}
\vec{Proj}_b &= \hat{x} \cdot \vec{a} 
\\ &= \vec{a} \cdot \hat{x} 
\\ &= \vec{a} \cdot \frac{\vec{a} ^ T \vec{b}} {\vec{a} ^ T \vec{a}}  
\\ &= \frac{\vec{a} \vec{a} ^ T} {\vec{a}^ T \vec{a}} \cdot \vec{b}
\end{aligned}
$$

å…¶ä¸­ $$ P = \frac{\vec{a} \cdot \vec{a} ^ T} {\vec{a}^ T  \cdot \vec{a}} $$ ä¸ºæŠ•å½±çŸ©é˜µã€‚ $$\hat{x}$$, x hat ä¸€èˆ¬è¡¨ç¤ºæ˜¯ä¸€ä¸ªä¼°è®¡å€¼ã€‚

{:.af-sectionDivider}
å¯¹äºå¤šå¤šå²›ä¸‰ä¸ªç«™ç‚¹çš„é—®é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿæƒ³æ‰¾åˆ°ä¸€ä¸ªæŠ•å½±ç›´çº¿ï¼Œä½¿å¾—è¿™ä¸ªæŠ•å½±ç›´çº¿ç¦»ä¸‰ä¸ªç«™ç‚¹çš„è·ç¦»éƒ½æ˜¯æœ€çŸ­çš„ï¼Œæ€ä¹ˆæ‰¾é‚£ï¼Ÿå‡è®¾ä¸‰ä¸ªç«™ç‚¹å¯¹åº”çš„å‘é‡åˆ†åˆ«ä¸º $$\vec{a}^T = (1, 2)$$, $$\vec{b}^T = (2, 1.7)$$, $$\vec{c}^T = (3.5, 3)$$ã€‚

å¯¹äºä¸€ç»´ç©ºé—´ä¸€ä¸ªå‘é‡æ±‚å…¶æŠ•å½±é—®é¢˜æŒ‰ä¸Šå¼å¾ˆç®€å•ï¼Œå¦‚æœç»™ä¸€ç»„å‘é‡æ€ä¹ˆæ±‚å…¶æŠ•å½±é‚£ï¼Ÿå‡è®¾ä¸€ç»„å‘é‡ç»„æˆçš„çŸ©é˜µä¸º $$X$$ æƒ³è¦è¡¨ç¤º $$\vec{y}$$ï¼Œæ€ä¹ˆæ±‚å‡ºè¿™è¡¨ç¤ºï¼Ÿå³æ±‚å‡º  $$X\vec{\theta} = \vec{y} $$, å…¶ä¸­ $$\vec{\theta} = (\theta_0, \theta_1, ...)^T$$ã€‚ é‚£ä¹ˆè¿™ä¸ªé—®é¢˜åˆ°å›åˆ°çº¿æ€§ä»£æ•°æœ€åŸºç¡€çŸ¥è¯†ç‚¹äº†ï¼Œå³ $$X\vec{\theta} = \vec{y} $$ æœ‰è§£å—ï¼Ÿ å¦‚æœæœ‰è§£å¯ä»¥æ¯«æ— è¯¯å·®çš„ç›´æ¥è¡¨ç¤º $$\vec{y}$$ äº†ï¼Œåœ¨äºŒç»´ä¸Šå°±æ˜¯å¯ä»¥ç›´æ¥ç”»å‡ºè¿™æ¡ç›´çº¿å‡ºæ¥ã€‚å¦‚æœæ— è§£é‚£ï¼Ÿé‚£å°±æ˜¯ä¸èƒ½ç›´æ¥æœ‰ $$X$$ çš„[åˆ—å­ç©ºé—´](https://en.wikipedia.org/wiki/Row_and_column_spaces)æ¥è¡¨ç¤º $$\vec{y}$$ äº†ï¼Œ åœ¨äºŒç»´ä¸Šå°±æ˜¯ç”»ä¸å‡ºç›´çº¿äº†ã€‚ 

å¦‚æœä¸èƒ½ç›´æ¥è¡¨ç¤ºé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‰¾ä¸€ä¸ªè¿‘ä¼¼çš„è¡¨ç¤ºå§ï¼Œä½¿å¾—è¡¨ç¤ºçš„è¯¯å·®æœ€å°ã€‚å‡è®¾ç”¨ $$X\vec{\hat{\theta}}$$ è¡¨ç¤º $$\vec{y}$$, è¯¯å·®å‘é‡ä¸º $$X\vec{\hat{\theta}} - \vec{y}$$ã€‚å½“è¯¯å·®å‘é‡ä¸ $$X$$ çš„åˆ—å­ç©ºé—´æ­£äº¤ï¼ˆå½“ç„¶ä¹Ÿä¸ $$X$$ æ­£äº¤ï¼‰æ—¶è¯¯å·®æœ€å°ï¼Œæ‰€ä»¥æœ‰ $$X^T(X\vec{\hat{\theta}} - \vec{y}) = \vec{0} $$ï¼Œ ä¸‹é¢æˆ‘å°±æ¥æ±‚å‡º $$\vec{\hat{\theta}}$$ .

**æ³¨ï¼š** $$\vec{a}$$ ä¸ $$\vec{b}$$ æ­£äº¤ï¼Œåˆ™ $$\vec{a}^T \vec{b} = \vec{b}^T \vec{a} = \vec{0}$$

$$
\begin{aligned}
    X^T(X\vec{\hat{\theta}} - \vec{y}) &= \vec{0} \\
    X^TX\vec{\hat{\theta}} &= X^T\vec{y} \\
    \hat{\vec{\theta}} &= (X^TX)^{-1}X^T\vec{y}
\end{aligned}
$$

$$\hat{\vec{\theta}}$$ å³æ˜¯æˆ‘ä»¬çš„è¯¯å·®è¡¨ç¤ºçš„æœ€ä¼˜è§£ã€‚äº›æ—¶æŠ•å½±ä¸º $$Proj  = X \cdot \hat{\vec{\theta}} = X \cdot (X^T X)^{-1} X ^ T \vec{y}$$,  è€Œ  $$ P = X \cdot (X^T X)^{-1} X ^ T$$ ä¸ºæŠ•å½±çŸ©é˜µã€‚

{:.af-sectionDivider}
### å¤šå¤šå²›çš„è§£å†³æ–¹æ¡ˆ

ä¸‹é¢ç”¨çº¿æ€§ä»£æ•°çš„æœ€ä¼˜è§£æ¥è§£å†³å¤šå¤šå²›çš„é—®é¢˜ã€‚é’ˆå¯¹è¿™ä¸ªæœ€ä¼˜é—®é¢˜ä¹Ÿå¯èƒ½æœ‰å¤šç§æ–¹æ¡ˆã€‚å¦‚è§„å®šè¿™æ¡é“è·¯è¦åŸå¸‚A, B çš„ä¸‹è¾¹ï¼ŒC çš„ä¸Šè¾¹ï¼Œé‚£å¯èƒ½ç”»å‡ºçš„å°±æ˜¯ Line 1, å¦‚æœè§„å®šé“è·¯è¦åœ¨åŸå¸‚ B çš„ä¸‹é¢ï¼ŒA, C çš„ä¸Šé¢ï¼Œé‚£å¯èƒ½ç”»å‡ºçš„å°±æ˜¯ Line 2ï¼Œå¦‚æœå…¨éƒ¨ä¸‰ç‚¹çš„ä¸Šé¢ä¸‹é¢ä¹Ÿæ˜¯å¯èƒ½çš„ã€‚(é“è·¯ä¸èƒ½ç›´æ¥å»ºä¸ŠåŸå¸‚ä¸Šï¼Œå› ä¸ºæ‰°æ°‘...ğŸ™ƒ)

{:.af-textAlignCenter}
![png](/assets/imgs/2017-04-01-two-lines.png)

æˆ‘ä»¬æ¥åˆ†ä¸ªç±»ï¼Œåœ¨çº¿ä¸Šè¾¹çš„æ ‡è®°ä¸º 1ï¼Œåœ¨çº¿ä¸‹è¾¹çš„æ ‡è®°ä¸º -1ã€‚ ç°åœ¨è§£å†³ A, B åœ¨çº¿çš„ä¸Šè¾¹ã€ C åœ¨çº¿ä¸‹é¢çš„æœ€ä½³ç›´çº¿çš„é—®é¢˜ã€‚é‚£ä¹ˆè¿™ä¸‰ä¸ªç‚¹çš„åˆ†ç±»æ˜¯ $$[1; 1; -1]$$ã€‚

æˆ‘ä»¬å‡è®¾è¿™æ¡ç›´çº¿ä¸ºï¼š $$h(x) = \theta_0 x_0 + \theta_1 x_1 + \theta_2 x_2  = \vec{\theta^T} \vec{x}$$, å…¶ä¸­ $$x_0 = 1$$ã€‚ ï¼ˆæˆ‘ä»¬å¹³é¢ä¸­è§çš„æœ€å¤šçš„ç›´çº¿è¡¨ç¤ºè¿˜æ˜¯ $$ax + by + c = 0$$ï¼‰.

æ ¹æ®ä¸Šé¢çº¿æ€§ä»£æ•°çš„æ¨å¯¼ï¼Œæˆ‘ä»¬å¯ä»¥æ±‚å‡ºæœ€ä¼˜è§£ $$ \hat{\vec{\theta}} = (X^TX)^{-1}X^T\vec{y} $$. å…¶ä¸­ X å°±æ˜¯$$(x_0, x_1, x_2)$$ ç»„æˆçš„çŸ©é˜µï¼Œ$$ y = [1; 1; -1]$$ æ˜¯ä¸‰ä¸ªåˆ†ç±»çš„æ ‡è¯†(Label).

$$
X = \begin{bmatrix} 1 & 1 & 1\\ 1 & 1.7 & 2\\ 1 & 2 & 1.6 \end{bmatrix} 
y = \begin{bmatrix} 1 \\ 1 \\ -1  \end{bmatrix} 
$$

ç”¨ Matlab è§£å†³è¿™ä¸ªé—®é¢˜, åœ¨ Matlab ä¸­è¾“å…¥ä¸‹é¢æŒ‡ä»¤ç®—å‡º $$\theta$$

```matlab
X = [1 1 1; 1 1.7 2; 1 2 1.6]
y = [1;1;-1]
thetas = inv(X.'*X)*X.'*y
```

æœ€åå¾—å‡ºï¼š 

$$
y = \begin{bmatrix} 2.0345 \\ -3.4483 \\ 2.4138  \end{bmatrix} 
$$

æ‰€ä»¥æˆ‘ä»¬çš„ç›´çº¿å°±æ˜¯ï¼š $$ -3.4483 x_1 + 2.4138 x_2 + 2.0345 = 0 $$.  ä¸‹é¢æˆ‘ä»¬ç”¨ python æˆ‘è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”ç”¨ matplotlib ç”»å‡ºè¿™æ¡ç›´çº¿ã€‚é¡ºä¾¿è¯´ä¸€ä¸‹æ±‚ $$\theta$$ çš„æ–¹æ³•æ˜¯[æœ€å°äºŒä¹˜æ³•(Least Squares Method,ç®€è®°ä¸ºLSE)](https://baike.baidu.com/item/%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95/2522346?fr=aladdin), è€Œ $$\theta$$ ç§°ä¸ºç³»æ•°(weights).

{:.af-sectionDivider}
### ä»£ç å®ç°

ä¸‰ä¸ªåŸå¸‚ï¼Œé€šè¿‡ä¸¤ç»„ä¸çš„æ ‡ç­¾ $$yLabels1 = [1, 1, -1]$$ å’Œ $$ yLabels2 = [1, -1, 1]$$æ¥ç”»å‡ºä¸¤æ¡æœ€ä¼˜çš„ç›´çº¿ã€‚

{:.af-textAlignCenter}
![png](/assets/imgs/2017-04-01-line-regression.png)

```python
import numpy as np

def get_LSE_weights(yLabels):
    ''' æœ€å°äºŒä¹˜æ³• '''
    y = np.mat(yLabels).T
    X = np.mat([[1, 1, 1], [1, 1.7, 2], [1, 2, 1.6]])
    return (X.T * X).I * X.T * y

def plotLine(ax, weights):
    x_1 = np.arange(0, 3.5, 0.1)
    x_2 = (-weights[0] - weights[1] * x_1) / weights[2] # x2 = (-w0 - w1*x1)/w2
    ax.plot(x_1, np.squeeze(np.asarray(x_2))) 

def plotIsland(ax, y):
    t = ['A', 'B', 'C']
    ax.set_xlim([0, 3])
    ax.set_ylim([0, 3])
    x1 = [1, 1.7, 2]
    x2 = [1, 2, 1.6]
    
    for i in range(3):
        m = 'x'
        if y[i] == -1: 
            m = 'o'
        ax.scatter(x1[i], x2[i], marker=m)    
        ax.annotate(t[i], (x1[i], x2[i] + 0.1))
    
    
fig, (ax1, ax2) = plt.subplots(1, 2)

yLabels1 = [1, 1, -1]
plotIsland(ax1, yLabels1)
yLabels2 = [1, -1, 1]
plotIsland(ax2, yLabels2)

weights = get_LSE_weights(yLabels1)
plotLine(ax1, weights)

weights = get_LSE_weights(yLabels2)
plotLine(ax2, weights)

plt.show()
```

{:.af-sectionDivider}
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¤šå¤šå²›çš„é“è·¯çº¿æ€»æ‰¾åˆ°äº†ã€‚**æˆ‘ä»¬æ‰¾åˆ°è¿™æ¡çº¿çš„è¿‡ç¨‹å°±æ˜¯å›å½’**ã€‚æ‰€ä»¥åˆ°ç›®å‰ä¸ºæ­¢æˆ‘ä»¬ã€çº¿æ€§å›å½’ã€æ€»ç®—è¿‡äº†åˆçº§é˜¶æ®µã€‚å›å½’è‹±æ–‡å•è¯ Regression çš„é‡Šä¹‰æ˜¯ `an abnormal state in which development has stopped prematurely` å³æ˜¯ä¸€ä¸ªä¸èƒ½å†è¿›åŒ–çš„æœ€ä¼˜è§£çŠ¶æ€ã€‚

åœ¨ä¸‹ä¸€ç¯‡ï¼Œæˆ‘ä»¬å°†ä»‹ç»çœŸæ­£çš„çº¿æ€§å›å½’ã€‚ä»æœºå™¨å­¦ä¹ çš„ hypothesis, cost function å‡ºå‘ï¼Œåˆ©ç”¨æ¢¯åº¦ç®—æ³•æ¥ä»‹ç»çº¿æ€§å›å½’ã€‚

